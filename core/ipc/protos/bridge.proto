syntax = "proto3";

package bridge;

service Bridge {
  rpc GetConfig (ConfigRequest) returns (ConfigResponse);
  rpc SetConfig (ConfigSetRequest) returns (ConfigResponse);
  rpc SubscribeToTasks (SubscribeRequest) returns (stream TaskUpdate);
  rpc ExecuteCommand (CommandRequest) returns (CommandResponse);
  rpc StreamSnapshots (SnapshotRequest) returns (stream Snapshot);
}

message ConfigRequest {
  string key = 1;
}

message ConfigSetRequest {
  string key = 1;
  string value = 2;
  string value_type = 3;
  bool is_secret = 4;
}

message ConfigResponse {
  bool success = 1;
  string message = 2;
  map<string, string> configs = 3;
}

message SubscribeRequest {
  string client_id = 1;
}

message TaskUpdate {
  string task_id = 1;
  string title = 2;
  string status = 3;
  string assignee = 4;
  string event_type = 5;
  int64 timestamp = 6;
}

message CommandRequest {
  string command_type = 1;
  string payload = 2;
}

message CommandResponse {
  bool success = 1;
  string message = 2;
}

message SnapshotRequest {
  int32 interval_ms = 1;
}

message Snapshot {
  string data = 1;
  int64 timestamp = 2;
}
